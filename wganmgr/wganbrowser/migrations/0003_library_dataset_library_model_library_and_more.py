# Generated by Django 4.1.3 on 2022-11-04 20:49

from django.db import migrations, models
import django.db.models.deletion

#
#
# NOTE: This migration was faked because could not add foreign keys for id=1 to newly created library table
# after running migrate and failing, had to go and manually run the following and then mark this migration as faked
#
#mysql> insert into wganbrowser_library (name,datasets_root,runs_root,snapshots_root) values ("test_library","/some/test/path/test_library/datasets","/some/test/path/test_library/runs","/some/test/path/test_library/snapshots");
#Query OK, 1 row affected (0.01 sec)
#
#mysql> select * from wganbrowser_library;
#+----+--------------+---------------------------------------+-----------------------------------+----------------------------------------+
#| id | name         | datasets_root                         | runs_root                         | snapshots_root                         |
#+----+--------------+---------------------------------------+-----------------------------------+----------------------------------------+
#|  1 | test_library | /some/test/path/test_library/datasets | /some/test/path/test_library/runs | /some/test/path/test_library/snapshots |
#+----+--------------+---------------------------------------+-----------------------------------+----------------------------------------+
#1 row in set (0.00 sec)
#
#mysql> select * from wganbrowser_dataset;
#+----+--------------------+------------+
#| id | path               | name       |
#+----+--------------------+------------+
#|  1 | /test/dataset/path | kick_set_1 |
#+----+--------------------+------------+
#1 row in set (0.00 sec)
#
#mysql> select * from wganbrowser_dataset;
#+----+--------------------+------------+
#| id | path               | name       |
#+----+--------------------+------------+
#|  1 | /test/dataset/path | kick_set_1 |
#+----+--------------------+------------+
#1 row in set (0.00 sec)
#
#mysql> ALTER TABLE `wganbrowser_dataset` ADD COLUMN `library_id` bigint DEFAULT 1 NOT NULL , ADD CONSTRAINT `wganbrowser_dataset_library_id_02ae8354_fk_wganbrows` FOREIGN KEY (`library_id`) REFERENCES `wganbrowser_library`(`id`);
#LTER TABLE `wganbrowser_dataset` ALTER COLUMN `library_id` DROP DEFAULT;Query OK, 1 row affected (0.09 sec)
#Records: 1  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_dataset` ALTER COLUMN `library_id` DROP DEFAULT;
#Query OK, 0 rows affected (0.02 sec)
#Records: 0  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_model` ADD COLUMN `library_id` bigint DEFAULT 1 NOT NULL , ADD CONSTRAINT `wganbrowser_model_library_id_60ef249f_fk_wganbrowser_library_id` FOREIGN KEY (`library_id`) REFERENCES `wganbrowser_library`(`id`);
#ER TABLE `wganbrowser_model` ALTER COLUMN `library_id` DROP DEFAULT;Query OK, 1 row affected (0.12 sec)
#Records: 1  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_model` ALTER COLUMN `library_id` DROP DEFAULT;
#Query OK, 0 rows affected (0.02 sec)
#Records: 0  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_modelrun` ADD COLUMN `library_id` bigint DEFAULT 1 NOT NULL , ADD CONSTRAINT `wganbrowser_modelrun_library_id_882eb4ec_fk_wganbrows` FOREIGN KEY (`library_id`) REFERENCES `wganbrowser_library`(`id`);
#R TABLE `wganbrowser_modelrun` ALTER COLUMN `library_id` DROP DEFAULT;Query OK, 1 row affected (0.08 sec)
#Records: 1  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_modelrun` ALTER COLUMN `library_id` DROP DEFAULT;
#Query OK, 0 rows affected (0.02 sec)
#Records: 0  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_modelsnapshot` ADD COLUMN `library_id` bigint DEFAULT 1 NOT NULL , ADD CONSTRAINT `wganbrowser_modelsna_library_id_37246e3c_fk_wganbrows` FOREIGN KEY (`library_id`) REFERENCES `wganbrowser_library`(`id`);
#LTER TABLE `wganbrowser_modelsnapshot` ALTER COLUMN `library_id` DROP DEFAULT;Query OK, 1 row affected (0.09 sec)
#Records: 1  Duplicates: 0  Warnings: 0
#
#mysql> ALTER TABLE `wganbrowser_modelsnapshot` ALTER COLUMN `library_id` DROP DEFAULT;
#Query OK, 0 rows affected (0.01 sec)
#Records: 0  Duplicates: 0  Warnings: 0
#
#
#
# python manage.py migrate --fake
#Operations to perform:
#  Apply all migrations: admin, auth, contenttypes, sessions, wganbrowser
#Running migrations:
#  Applying wganbrowser.0003_library_dataset_library_model_library_and_more... FAKED
#

class Migration(migrations.Migration):

    dependencies = [
        ('wganbrowser', '0002_alter_model_data_prefetch_gpu_num_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='library',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=64)),
                ('datasets_root', models.CharField(max_length=512)),
                ('runs_root', models.CharField(max_length=512)),
                ('snapshots_root', models.CharField(max_length=512)),
            ],
        ),
        migrations.AddField(
            model_name='dataset',
            name='library',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, to='wganbrowser.library'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='model',
            name='library',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, to='wganbrowser.library'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='modelrun',
            name='library',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, to='wganbrowser.library'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='modelsnapshot',
            name='library',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, to='wganbrowser.library'),
            preserve_default=False,
        ),
    ]
